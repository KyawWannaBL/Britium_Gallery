<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Orders | Britium Admin</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Jost:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    /* --- RESET & LAYOUT --- */
    :root {
      --bg-dark: #141414;
      --bg-light: #f4f6f8;
      --white: #ffffff;
      --text-dark: #333333;
      --text-grey: #6b7280;
      --border-color: #e5e7eb;
      --primary-gold: #c6a87c;
      --primary-blue: #1a1a1a; 
      --status-green-bg: #dcfce7; --status-green-text: #166534;
      --status-red-bg: #fee2e2; --status-red-text: #991b1b;
      --status-yellow-bg: #fef3c7; --status-yellow-text: #92400e;
    }

    body { margin:0; font-family:'Inter', sans-serif; background:var(--bg-light); color:var(--text-dark); display:flex; }
    
    /* --- SIDEBAR --- */
    .sidebar { width: 260px; background: var(--bg-dark); color: #fff; height: 100vh; position: fixed; left: 0; top: 0; padding: 25px; box-sizing: border-box; display: flex; flex-direction: column; z-index: 100; }
    .sidebar h2 { color: var(--primary-gold); text-align: center; margin-bottom: 40px; font-family: 'Jost', sans-serif; letter-spacing: 1px; }
    .nav-link { display: flex; align-items: center; gap: 10px; padding: 12px 15px; color: #aaa; text-decoration: none; margin-bottom: 5px; border-radius: 8px; transition: 0.2s; font-size: 0.95rem; }
    .nav-link:hover, .nav-link.active { background: #333; color: #fff; }
    .nav-link.active { border-left: 3px solid var(--primary-gold); }
    .mt-auto { margin-top: auto; }

    /* --- MAIN CONTENT --- */
    main.main-content { margin-left: 260px; padding: 40px; width: 100%; box-sizing: border-box; }
    
    h1 { font-size:1.8rem; margin:0 0 5px 0; font-family: 'Jost', sans-serif; }
    .muted { color:var(--text-grey); margin-bottom: 30px; font-size: 0.9rem; }

    .panel { background:var(--white); border-radius:12px; padding:25px; border:1px solid var(--border-color); box-shadow:0 4px 6px -1px rgba(0,0,0,0.05); }

    /* --- FILTERS --- */
    .filters { display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:15px; margin-bottom:25px; }
    .field { display:flex; flex-direction:column; gap:5px; }
    .field label { font-size:.75rem; text-transform:uppercase; font-weight:700; color:var(--text-grey); }
    .field input, .field select { padding:10px; border-radius:6px; border:1px solid var(--border-color); outline:none; font-family:inherit; }

    /* --- TABLE --- */
    table { width:100%; border-collapse:collapse; font-size:0.9rem; }
    th { text-align:left; padding:12px; border-bottom:1px solid var(--border-color); color:var(--text-grey); font-size:0.8rem; text-transform:uppercase; letter-spacing:0.05em; }
    td { padding:16px 12px; border-bottom:1px solid #f1f5f9; vertical-align:middle; }

    .status { padding:4px 10px; border-radius:20px; font-size:0.75rem; font-weight:600; text-transform:capitalize; }
    .completed { background:var(--status-green-bg); color:var(--status-green-text); }
    .pending { background:var(--status-yellow-bg); color:var(--status-yellow-text); }
    .cancelled { background:var(--status-red-bg); color:var(--status-red-text); }

    .view-btn { background:none; border:none; color:var(--primary-blue); font-weight:600; cursor:pointer; }
    .view-btn:hover { text-decoration: underline; color: var(--primary-gold); }

    /* --- MODAL (POPUP) --- */
    .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 1000; }
    .modal { background: #fff; width: 500px; max-width: 90%; border-radius: 12px; overflow: hidden; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); }
    
    .modal-header { padding: 20px; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; background: #f8fafc; }
    .modal-header h2 { margin: 0; font-size: 1.1rem; }
    .close-btn { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #64748b; }
    
    .modal-body { padding: 20px; }
    
    .order-info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
    .info-group label { display: block; font-size: 0.75rem; color: #64748b; text-transform: uppercase; margin-bottom: 3px; }
    .info-group div { font-weight: 500; font-size: 0.95rem; }

    .order-items { background: #f8fafc; border-radius: 8px; padding: 15px; margin-bottom: 20px; }
    .item-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.9rem; }
    .item-row:last-child { margin-bottom: 0; }
    .item-total { border-top: 1px solid #cbd5e1; margin-top: 10px; padding-top: 10px; font-weight: 700; display: flex; justify-content: space-between; }

    .modal-actions { padding: 20px; background: #f8fafc; border-top: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; }
    .btn-status { padding: 8px 15px; border-radius: 6px; border: none; font-weight: 600; cursor: pointer; font-size: 0.85rem; margin-right: 5px; }
    .btn-complete { background: var(--status-green-bg); color: var(--status-green-text); }
    .btn-cancel { background: var(--status-red-bg); color: var(--status-red-text); }
    .btn-delete { background: #ef4444; color: white; margin-left: auto; }
  </style>

  <script>
    const session = localStorage.getItem("britium_admin_session");
    if (!session) window.location.href = "../admin-login.html";
  </script>
</head>

<body>

  <aside class="sidebar">
    <h2>BRITIUM ADMIN</h2>
    <a href="dashboard/index.html" class="nav-link"><span>üè†</span> Dashboard</a>
    <a href="orders.html" class="nav-link active"><span>üì¶</span> Orders</a>
    <a href="products.html" class="nav-link"><span>üëú</span> Products</a>
    <a href="customers.html" class="nav-link"><span>üë§</span> Customers</a>
    <a href="reports.html" class="nav-link"><span>üìà</span> Analytics</a>
    <a href="staff.html" class="nav-link"><span>üõ°Ô∏è</span> Staff</a>
    <a href="#" class="nav-link mt-auto" onclick="logout()"><span>üö™</span> Logout</a>
  </aside>

  <main class="main-content">
    <h1>Orders Management</h1>
    <p class="muted">Track and update customer orders.</p>

    <div class="panel">
      
      <div class="filters">
        <div class="field">
          <label>Order ID</label>
          <input type="text" id="searchId" placeholder="#BG..." onkeyup="renderTable()">
        </div>
        <div class="field">
          <label>Status</label>
          <select id="filterStatus" onchange="renderTable()">
            <option value="">All Statuses</option>
            <option value="Completed">Completed</option>
            <option value="Pending">Pending</option>
            <option value="Cancelled">Cancelled</option>
          </select>
        </div>
        <div class="field">
          <label>Date</label>
          <input type="date">
        </div>
      </div>

      <table>
        <thead>
          <tr>
            <th>Order ID</th>
            <th>Customer</th>
            <th>Date</th>
            <th>Total (MMK)</th>
            <th>Status</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="ordersBody">
          </tbody>
      </table>
    </div>
  </main>

  <div class="modal-overlay" id="orderModal">
    <div class="modal">
      <div class="modal-header">
        <h2 id="modalOrderId">Order #...</h2>
        <button class="close-btn" onclick="closeModal()">&times;</button>
      </div>

      <div class="modal-body">
        <div class="order-info-grid">
          <div class="info-group">
            <label>Customer Name</label>
            <div id="modalCustomer">...</div>
          </div>
          <div class="info-group">
            <label>Order Date</label>
            <div id="modalDate">...</div>
          </div>
          <div class="info-group">
            <label>Email</label>
            <div id="modalEmail">...</div>
          </div>
          <div class="info-group">
            <label>Phone</label>
            <div id="modalPhone">...</div>
          </div>
        </div>

        <div class="order-items">
          <div id="modalItemsList">
            </div>
          <div class="item-total">
            <span>TOTAL</span>
            <span id="modalTotal">...</span>
          </div>
        </div>
      </div>

      <div class="modal-actions">
        <div>
          <span style="font-size:0.75rem; font-weight:700; color:#64748b; margin-right:10px;">MARK AS:</span>
          <button class="btn-status btn-complete" onclick="updateStatus('Completed')">Completed</button>
          <button class="btn-status btn-cancel" onclick="updateStatus('Cancelled')">Cancelled</button>
        </div>
        <button class="btn-status btn-delete" onclick="deleteOrder()">Delete</button>
      </div>
    </div>
  </div>

  <script>
    // --- MOCK DATA ---
    let orders = JSON.parse(localStorage.getItem('britium_orders')) || [
      { id: "BG10236", customer: "Min Thu", email: "min@test.com", phone:"0977889900", date: "2025-01-14", total: 168000, status: "Cancelled", items: [{name: "Leather Wallet", price: 168000}] },
      { id: "BG10235", customer: "Aye Myat", email: "aye@test.com", phone:"0911223344", date: "2025-01-13", total: 225000, status: "Pending", items: [{name: "Silk Scarf", price: 225000}] },
      { id: "BG10234", customer: "Kyaw Wanna", email: "kyaw@test.com", phone:"0955667788", date: "2025-01-12", total: 485000, status: "Completed", items: [{name: "Luxury Tote", price: 450000}, {name: "Cleaning Kit", price: 35000}] }
    ];

    let currentOrderId = null;

    // --- RENDER TABLE ---
    function renderTable() {
      const tbody = document.getElementById("ordersBody");
      const search = document.getElementById("searchId").value.toLowerCase();
      const statusFilter = document.getElementById("filterStatus").value;

      tbody.innerHTML = "";

      orders.forEach(order => {
        // Filter Logic
        if (!order.id.toLowerCase().includes(search)) return;
        if (statusFilter && order.status !== statusFilter) return;

        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td><strong>#${order.id}</strong></td>
          <td>${order.customer}</td>
          <td>${order.date}</td>
          <td>${order.total.toLocaleString()}</td>
          <td><span class="status ${order.status.toLowerCase()}">${order.status}</span></td>
          <td><button class="view-btn" onclick="openModal('${order.id}')">View</button></td>
        `;
        tbody.appendChild(tr);
      });

      localStorage.setItem('britium_orders', JSON.stringify(orders));
    }

    // --- MODAL FUNCTIONS ---
    function openModal(id) {
      const order = orders.find(o => o.id === id);
      if(!order) return;

      currentOrderId = id;

      document.getElementById("modalOrderId").innerText = `Order #${order.id}`;
      document.getElementById("modalCustomer").innerText = order.customer;
      document.getElementById("modalDate").innerText = order.date;
      document.getElementById("modalEmail").innerText = order.email;
      document.getElementById("modalPhone").innerText = order.phone;
      document.getElementById("modalTotal").innerText = `MMK ${order.total.toLocaleString()}`;

      const list = document.getElementById("modalItemsList");
      list.innerHTML = "";
      order.items.forEach(item => {
        list.innerHTML += `
          <div class="item-row">
            <span>${item.name}</span>
            <span>${item.price.toLocaleString()}</span>
          </div>
        `;
      });

      document.getElementById("orderModal").style.display = "flex";
    }

    function closeModal() {
      document.getElementById("orderModal").style.display = "none";
    }

    // --- ACTIONS ---
    function updateStatus(newStatus) {
      if(!currentOrderId) return;
      
      const idx = orders.findIndex(o => o.id === currentOrderId);
      if(idx > -1) {
        orders[idx].status = newStatus;
        renderTable();
        closeModal();
      }
    }

    function deleteOrder() {
      if(!currentOrderId) return;
      if(confirm("Permanently delete this order?")) {
        orders = orders.filter(o => o.id !== currentOrderId);
        renderTable();
        closeModal();
      }
    }

    function logout() {
      if(confirm("Logout?")) {
        localStorage.removeItem("britium_admin_session");
        window.location.href = "../admin-login.html";
      }
    }

    // Initial Load
    renderTable();
  </script>

</body>
</html>
